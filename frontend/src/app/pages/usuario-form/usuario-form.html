<div class="max-w-4xl mx-auto p-8 bg-white shadow-xl rounded-lg mt-10 border border-indigo-200">
    <h1 class="text-3xl font-bold text-indigo-700 mb-6 border-b pb-2">Registrar Nuevo Usuario</h1>

    <!-- Mensajes de Estado -->
    @if (error) {
        <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
            <strong class="font-bold">Error:</strong>
            <span class="block sm:inline ml-2">{{ error }}</span>
        </div>
    }
    @if (message) {
        <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded relative mb-4" role="alert">
            <strong class="font-bold">Éxito:</strong>
            <span class="block sm:inline ml-2">{{ message }}</span>
        </div>
    }

    <form (ngSubmit)="registerUser()" class="space-y-6">
        
        <!-- Datos Personales -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="first_name" class="block text-sm font-medium text-gray-700 mb-1">Nombre</label>
                <input id="first_name" name="first_name" type="text" 
                       [(ngModel)]="credentials.first_name" required
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </div>

            <div>
                <label for="last_name" class="block text-sm font-medium text-gray-700 mb-1">Apellido</label>
                <input id="last_name" name="last_name" type="text" 
                       [(ngModel)]="credentials.last_name" required
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </div>
        </div>
        
        <!-- Email y Username -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="username" class="block text-sm font-medium text-gray-700 mb-1">Nombre de Usuario</label>
                <input id="username" name="username" type="text" 
                       [(ngModel)]="credentials.username" required
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </div>

            <div>
                <label for="email" class="block text-sm font-medium text-gray-700 mb-1">Correo Electrónico</label>
                <input id="email" name="email" type="email" 
                       [(ngModel)]="credentials.email" required
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </div>
        </div>

        <!-- Contraseñas -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
                <label for="password1" class="block text-sm font-medium text-gray-700 mb-1">Contraseña</label>
                <input id="password1" name="password1" type="password" 
                       [(ngModel)]="credentials.password1" required
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </div>

            <div>
                <label for="password2" class="block text-sm font-medium text-gray-700 mb-1">Confirmar Contraseña</label>
                <input id="password2" name="password2" type="password" 
                       [(ngModel)]="credentials.password2" required
                       class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
            </div>
        </div>

        <!-- Selección de Rol (Solo para Admin) -->
        <div>
            <label for="rol" class="block text-sm font-medium text-gray-700 mb-1">Asignar Rol</label>
            <select id="rol" name="rol" 
                    [(ngModel)]="credentials.rol" required
                    class="mt-1 block w-full px-3 py-2 border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500">
                @for (rol of roles; track rol.value) {
                    <option [value]="rol.value">{{ rol.name }}</option>
                }
            </select>
        </div>

        <!-- Botón de Registro -->
        <button type="submit" [disabled]="loading"
                class="w-full flex justify-center py-3 px-4 border border-transparent rounded-md shadow-sm text-lg font-medium text-white transition duration-150"
                [ngClass]="{'bg-indigo-600 hover:bg-indigo-700': !loading, 'bg-gray-400 cursor-not-allowed': loading}">
            @if (loading) {
                Registrando...
            } @else {
                Registrar Usuario
            }
        </button>
    </form>
</div>